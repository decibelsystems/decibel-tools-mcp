id: DOJO-PROP-0001
title: MCP Tool Registration Validator
owner: ai
target_module: tools
problem: server.ts has 2000+ lines with tool definitions in ListToolsRequestSchema
  and handlers in CallToolRequestSchema. When adding tools, it's easy to add a definition
  but forget the handler (or vice versa), causing runtime errors.
hypothesis: Static analysis can detect mismatches between tool definitions and handlers,
  catching errors before runtime.
scope:
  in:
  - 'Parse server.ts to extract tool names from ListToolsRequestSchema'
  - 'Parse server.ts to extract case labels from CallToolRequestSchema switch'
  - 'Report tools defined but not handled'
  - 'Report handlers without matching definitions'
  out:
  - 'Auto-fixing mismatches'
  - 'Validating tool input schemas'
  - 'Runtime validation'
acceptance:
- 'Running validator on current server.ts reports no mismatches (since we just fixed it)'
- 'Intentionally removing a handler causes validator to report the mismatch'
- 'Exit code non-zero when mismatches found'
risks:
- 'Regex parsing may miss edge cases in complex code'
- 'False positives if code structure changes significantly'
rollout:
  default_enabled: false
  enable_rule: manual
created_at: '2025-12-14T23:28:18.376256+00:00'
